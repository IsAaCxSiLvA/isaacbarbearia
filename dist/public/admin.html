<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel Admin - Isaac Barbearia</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: Arial, sans-serif; 
      background: #1a1a1a; 
      color: #e0e0e0;
    }
    .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
    h1 { 
      color: #ff8c00; 
      text-align: center; 
      margin-bottom: 30px; 
      text-shadow: 0 0 10px rgba(255, 140, 0, 0.3);
    }
    h2 { 
      color: #ff8c00; 
      margin-bottom: 20px; 
    }
    .tabs { 
      display: flex; 
      gap: 10px; 
      margin-bottom: 30px; 
      border-bottom: 2px solid #333;
      flex-wrap: wrap;
    }
    .tabs button {
      padding: 14px 24px; 
      background: #2a2a2a; 
      color: #b0b0b0;
      border: none;
      cursor: pointer; 
      font-size: 16px; 
      border-radius: 8px;
      transition: all 0.3s;
      font-weight: 500;
    }
    .tabs button.active { 
      background: #ff8c00; 
      color: #000; 
    }
    .tabs button:hover { 
      background: #ff8c00; 
      color: #000; 
    }
    .btn-logout { 
      margin-left: auto; 
      background: #e74c3c !important;
    }
    .btn-logout:hover {
      background: #c0392b !important;
    }
    .tab-content { 
      display: none; 
      animation: fadeIn 0.3s; 
      background: #242424; 
      padding: 20px; 
      border-radius: 8px;
      border: 1px solid #333;
    }
    .tab-content.active { 
      display: block; 
    }
    @keyframes fadeIn { 
      from { opacity: 0; } 
      to { opacity: 1; } 
    }
    form {
      background: #2a2a2a; 
      padding: 20px; 
      border-radius: 8px;
      margin-bottom: 30px; 
      display: flex; 
      flex-direction: column; 
      gap: 10px;
      border: 1px solid #333;
    }
    input, textarea {
      padding: 10px; 
      border: 1px solid #444; 
      border-radius: 4px;
      font-size: 14px; 
      font-family: Arial, sans-serif;
      background: #1a1a1a;
      color: #e0e0e0;
    }
    input:focus, textarea:focus {
      outline: none;
      border-color: #ff8c00;
      box-shadow: 0 0 5px rgba(255, 140, 0, 0.3);
    }
    textarea { 
      resize: vertical; 
      min-height: 80px; 
    }
    button[type="submit"] {
      padding: 12px 20px; 
      background: #ff8c00; 
      color: #000;
      border: none; 
      border-radius: 4px; 
      cursor: pointer; 
      font-size: 16px;
      font-weight: bold;
      transition: all 0.3s;
    }
    button[type="submit"]:hover { 
      background: #ffaa00;
      box-shadow: 0 0 10px rgba(255, 140, 0, 0.5);
    }
    table {
      width: 100%; 
      border-collapse: collapse; 
      margin-top: 20px;
      background: #2a2a2a; 
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      border: 1px solid #333;
    }
    thead { 
      background: #ff8c00; 
      color: #000;
    }
    th, td { 
      padding: 12px; 
      text-align: left; 
      border-bottom: 1px solid #333;
    }
    tbody tr:hover { 
      background: #333;
    }
    .btn-delete {
      padding: 6px 12px; 
      background: #e74c3c; 
      color: white;
      border: none; 
      border-radius: 4px; 
      cursor: pointer;
      transition: all 0.3s;
    }
    .btn-delete:hover { 
      background: #c0392b;
      box-shadow: 0 0 8px rgba(231, 76, 60, 0.5);
    }
    .cards {
      display: grid; 
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px; 
      margin-top: 20px;
    }
    .card {
      background: #2a2a2a; 
      padding: 20px; 
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
      border: 1px solid #444;
    }
    .card h3 { 
      margin: 0 0 12px 0; 
      color: #ff8c00;
      font-size: 18px;
    }
    .card p { 
      margin: 8px 0; 
      color: #d0d0d0;
      line-height: 1.5;
    }
    .card small {
      color: #999;
      font-size: 13px;
    }
    .card button { 
      width: 100%; 
      margin-top: 15px; 
    }

    /* RESPONSIVO */
    @media (max-width: 768px) {
      .container { 
        padding: 12px; 
      }
      h1 { 
        font-size: 24px; 
        margin-bottom: 20px;
      }
      h2 { 
        font-size: 19px;
        margin-bottom: 16px;
      }
      .tabs { 
        display: flex;
        flex-direction: column;
        gap: 10px;
        border-bottom: none;
        margin-bottom: 20px;
      }
      .tabs button {
        padding: 18px 16px; 
        font-size: 16px;
        border-radius: 10px;
        font-weight: 600;
        width: 100%;
      }
      .btn-logout { 
        background: #e74c3c !important;
        margin-top: 5px;
      }
      .tab-content {
        padding: 16px;
        border-radius: 12px;
      }
      form {
        padding: 16px; 
        gap: 14px;
        border-radius: 12px;
      }
      input, textarea {
        font-size: 16px;
        padding: 16px;
        border-radius: 10px;
      }
      button[type="submit"] {
        padding: 18px;
        font-size: 17px;
        font-weight: 600;
        border-radius: 10px;
      }
      
      /* Tabelas viram cards no mobile */
      table, thead, tbody, th, td, tr { 
        display: block; 
      }
      thead tr { 
        position: absolute;
        top: -9999px;
        left: -9999px;
      }
      tr { 
        margin-bottom: 15px;
        background: #2a2a2a;
        border: 1px solid #333;
        border-radius: 8px;
        padding: 15px;
      }
      td { 
        border: none;
        position: relative;
        padding: 12px 12px 12px 50%;
        text-align: right;
      }
      td:before { 
        content: attr(data-label);
        position: absolute;
        left: 15px;
        width: 45%;
        padding-right: 10px;
        white-space: nowrap;
        text-align: left;
        font-weight: bold;
        color: #ff8c00;
      }
      .cards {
        grid-template-columns: 1fr;
        gap: 15px;
      }
      .card {
        padding: 15px;
      }
    }

    @media (max-width: 480px) {
      .container { 
        padding: 8px; 
      }
      h1 { 
        font-size: 20px;
        margin-bottom: 12px;
      }
      h2 { 
        font-size: 16px;
        margin-bottom: 12px;
      }
      .tabs { 
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .tabs button {
        padding: 18px; 
        font-size: 16px;
        border-radius: 10px;
        font-weight: 600;
        width: 100%;
      }
      .btn-logout { 
        order: 999;
        padding: 18px !important;
        font-size: 16px !important;
        margin-top: 10px;
        background: #e74c3c !important;
      }
      .tab-content {
        padding: 16px;
        border-radius: 12px;
      }
      form {
        padding: 16px; 
        gap: 14px;
        border-radius: 12px;
      }
      input, textarea {
        font-size: 16px;
        padding: 16px;
        border-radius: 10px;
      }
      button[type="submit"] {
        padding: 18px;
        font-size: 17px;
        font-weight: 600;
        border-radius: 10px;
      }
      td { 
        padding: 14px 14px 14px 50%;
        font-size: 15px;
      }
      td:before {
        font-size: 14px;
        font-weight: 600;
      }
      .btn-delete {
        padding: 14px 16px;
        font-size: 16px;
        font-weight: 600;
        width: 100%;
        margin-top: 10px;
        border-radius: 10px;
      }
        font-weight: bold;
        color: #ff8c00;
        display: inline-block;
        width: 100px;
        margin-right: 10px;
      }
      .btn-delete {
        width: 100%;
        padding: 10px;
      }
      .cards {
        grid-template-columns: 1fr;
        gap: 12px;
      }
      .card {
        padding: 12px;
      }
      .card h3 {
        font-size: 16px;
      }
      .card p {
        font-size: 13px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Painel Admin - Isaac Barbearia</h1>
    
    <div class="tabs">
      <button class="active" onclick="showTab('servicos')">Servi√ßos</button>
      <button onclick="showTab('profissionais')">Profissionais</button>
      <button onclick="showTab('parceiros')">Parceiros</button>
      <button onclick="showTab('participacoes')">Participa√ß√£o</button>
      <button onclick="showTab('localizacao')">Localiza√ß√£o</button>
      <button onclick="showTab('horarios')">Hor√°rios</button>
      <button onclick="showTab('agendamento')">Agendamento</button>
      <button onclick="showTab('avaliacoes')">Avalia√ß√µes</button>
      <button class="btn-logout" onclick="logout()">Sair</button>
    </div>

    <!-- SERVI√áOS -->
    <div id="servicos" class="tab-content active">
      <h2>Gerenciar Servi√ßos & Pre√ßos</h2>
      <form onsubmit="addServico(event)">
        <input type="text" id="serv-nome" placeholder="Nome do Servi√ßo" required>
        <select id="serv-realiza" required>
          <option value="">Realizamos este servi√ßo?</option>
          <option value="true">Sim</option>
          <option value="false">N√£o</option>
        </select>
        <input type="number" id="serv-preco" placeholder="Pre√ßo (em R$)" step="0.01" min="0">
        <button type="submit">Adicionar Servi√ßo</button>
      </form>
      <table>
        <thead><tr><th>Servi√ßo</th><th>Realizamos?</th><th>Pre√ßo</th><th>A√ß√µes</th></tr></thead>
        <tbody id="serv-list"></tbody>
      </table>
    </div>

    <!-- PROFISSIONAIS -->
    <div id="profissionais" class="tab-content">
      <h2>Gerenciar Profissionais</h2>
      <form onsubmit="addProfissional(event)">
        <input type="text" id="prof-nome" placeholder="Nome" required>
        <input type="text" id="prof-esp" placeholder="Especialidade" required>
        <input type="text" id="prof-tel" placeholder="Telefone">
        <input type="url" id="prof-img" placeholder="Link da Imagem (URL)">
        <button type="submit">Adicionar Profissional</button>
      </form>
      <table>
        <thead><tr><th>Nome</th><th>Especialidade</th><th>Imagem</th><th>A√ß√µes</th></tr></thead>
        <tbody id="prof-list"></tbody>
      </table>
    </div>

    <!-- PARCEIROS -->
    <div id="parceiros" class="tab-content">
      <h2>Gerenciar Parcerias</h2>
      <form onsubmit="addParceiro(event)">
        <input type="text" id="parc-nome" placeholder="Nome da Parceria" required>
        <input type="url" id="parc-img" placeholder="Link do Logo (URL)" required>
        <button type="submit">Adicionar Parceria</button>
      </form>
      <table>
        <thead><tr><th>Nome</th><th>Logo</th><th>A√ß√µes</th></tr></thead>
        <tbody id="parc-list"></tbody>
      </table>
    </div>

    <!-- PARTICIPA√á√ÉO -->
    <div id="participacoes" class="tab-content">
      <h2>Participa√ß√£o Comunit√°ria</h2>
      <form onsubmit="addParticipacao(event)">
        <input type="text" id="part-titulo" placeholder="T√≠tulo do Evento" required>
        <textarea id="part-desc" placeholder="Descri√ß√£o"></textarea>
        <input type="date" id="part-data" required>
        <button type="submit">Adicionar Evento</button>
      </form>
      <div class="cards" id="part-list"></div>
    </div>

    <!-- LOCALIZA√á√ÉO -->
    <div id="localizacao" class="tab-content">
      <h2>Localiza√ß√£o</h2>
      <form onsubmit="saveLocalizacao(event)">
        <input type="text" id="loc-endereco" placeholder="Endere√ßo completo" required>
        <input type="text" id="loc-bairro" placeholder="Bairro" required>
        <input type="text" id="loc-cidade" placeholder="Cidade" required>
        <input type="text" id="loc-referencia" placeholder="Refer√™ncia (ex: Pr√≥ximo √† pra√ßa)" required>
        <button type="submit">Salvar Localiza√ß√£o</button>
      </form>
      <div id="loc-display" style="margin-top: 20px; padding: 15px; background: #2a2a2a; border-radius: 8px; border: 1px solid #333;"></div>
    </div>

    <!-- HOR√ÅRIOS -->
    <div id="horarios" class="tab-content">
      <h2>Hor√°rios de Funcionamento</h2>
      <form onsubmit="saveHorarios(event)">
        <input type="text" id="hor-seg-sex" placeholder="Seg-Sex (ex: 09:00 √†s 20:00)" required>
        <input type="text" id="hor-sabado" placeholder="S√°bado (ex: 09:00 √†s 18:00)" required>
        <input type="text" id="hor-domingo" placeholder="Domingo (ex: Fechado)" required>
        <button type="submit">Salvar Hor√°rios</button>
      </form>
      <div id="hor-display" style="margin-top: 20px; padding: 15px; background: #2a2a2a; border-radius: 8px; border: 1px solid #333;"></div>
    </div>

    <!-- AGENDAMENTO -->
    <div id="agendamento" class="tab-content">
      <h2>Informa√ß√µes de Agendamento</h2>
      <form onsubmit="saveAgendamento(event)">
        <input type="text" id="agen-whatsapp" placeholder="N√∫mero WhatsApp (ex: 11 99999-9999)" required>
        <input type="tel" id="agen-telefone" placeholder="Telefone (ex: 11 3333-3333)" required>
        <textarea id="agen-info" placeholder="Informa√ß√µes adicionais sobre agendamento" required></textarea>
        <button type="submit">Salvar Agendamento</button>
      </form>
      <div id="agen-display" style="margin-top: 20px; padding: 15px; background: #2a2a2a; border-radius: 8px; border: 1px solid #333;"></div>
    </div>

    <!-- AVALIA√á√ïES -->
    <div id="avaliacoes" class="tab-content">
      <h2>Avalia√ß√µes dos Clientes</h2>
      <div class="cards" id="aval-list"></div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getAuth, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
    import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, onSnapshot, setDoc, getDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "AIzaSyDE2tWDNCDrY6O20EWrDt-NkvZmCm_MR10",
      authDomain: "isaacbarbearia-admin.firebaseapp.com",
      projectId: "isaacbarbearia-admin",
      storageBucket: "isaacbarbearia-admin.firebasestorage.app",
      messagingSenderId: "308982033120",
      appId: "1:308982033120:web:38b82c1a3ca9e933be7e85"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Verifica autentica√ß√£o
    onAuthStateChanged(auth, (user) => {
      if (!user) {
        window.location.href = '/isaacbarbearia/login.html';
      } else {
        // Carregar dados AP√ìS autentica√ß√£o
        console.log('Usu√°rio autenticado, carregando dados...');
        loadProfissionais();
        loadParceiros();
        loadParticipacoes();
        loadAvaliacoes();
      }
    });

    // Tabs
    window.showTab = (tabName) => {
      document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tabs button').forEach(b => b.classList.remove('active'));
      document.getElementById(tabName).classList.add('active');
      event.target.classList.add('active');
    };

    // Logout
    window.logout = async () => {
      await signOut(auth);
      window.location.href = '/isaacbarbearia/login.html';
    };

    // Servi√ßos
    window.addServico = async (e) => {
      e.preventDefault();
      const realiza = document.getElementById('serv-realiza').value === 'true';
      const preco = document.getElementById('serv-preco').value;
      await addDoc(collection(db, 'servicos'), {
        nome: document.getElementById('serv-nome').value,
        realiza: realiza,
        preco: realiza && preco ? parseFloat(preco) : 0
      });
      e.target.reset();
      loadServicos();
    };

    async function loadServicos() {
      const list = document.getElementById('serv-list');
      const snapshot = await getDocs(collection(db, 'servicos'));
      const rows = [];
      snapshot.forEach(doc => {
        const data = doc.data();
        const realizaText = data.realiza ? 'Sim' : 'N√£o';
        const precoText = data.realiza && data.preco > 0 ? `R$ ${data.preco.toFixed(0)}` : '-';
        rows.push(`<tr>
          <td data-label="Servi√ßo">${data.nome}</td>
          <td data-label="Realizamos?">${realizaText}</td>
          <td data-label="Pre√ßo">${precoText}</td>
          <td data-label="A√ß√µes"><button class="btn-delete" onclick="deleteServico('${doc.id}')">Deletar</button></td>
        </tr>`);
      });
      list.innerHTML = rows.join('');
    }

    window.deleteServico = async (id) => {
      await deleteDoc(doc(db, 'servicos', id));
      loadServicos();
    };

    // Profissionais
    window.addProfissional = async (e) => {
      e.preventDefault();
      await addDoc(collection(db, 'profissionais'), {
        nome: document.getElementById('prof-nome').value,
        especialidade: document.getElementById('prof-esp').value,
        telefone: document.getElementById('prof-tel').value,
        imagem: document.getElementById('prof-img').value
      });
      e.target.reset();
      loadProfissionais();
    };

    async function loadProfissionais() {
      const list = document.getElementById('prof-list');
      const snapshot = await getDocs(collection(db, 'profissionais'));
      const rows = [];
      snapshot.forEach(doc => {
        const data = doc.data();
        const imgHtml = data.imagem ? `<img src="${data.imagem}" alt="${data.nome}" style="width:50px;height:50px;border-radius:50%;object-fit:cover;">` : '-';
        rows.push(`<tr>
          <td data-label="Nome">${data.nome}</td>
          <td data-label="Especialidade">${data.especialidade}</td>
          <td data-label="Imagem">${imgHtml}</td>
          <td data-label="A√ß√µes"><button class="btn-delete" onclick="deleteProfissional('${doc.id}')">Deletar</button></td>
        </tr>`);
      });
      list.innerHTML = rows.join('');
    }

    window.deleteProfissional = async (id) => {
      await deleteDoc(doc(db, 'profissionais', id));
      loadProfissionais();
    };

    // Parceiros
    window.addParceiro = async (e) => {
      e.preventDefault();
      await addDoc(collection(db, 'parceiros'), {
        nome: document.getElementById('parc-nome').value,
        imagem: document.getElementById('parc-img').value
      });
      e.target.reset();
      loadParceiros();
    };

    async function loadParceiros() {
      const list = document.getElementById('parc-list');
      const snapshot = await getDocs(collection(db, 'parceiros'));
      const rows = [];
      snapshot.forEach(doc => {
        const data = doc.data();
        const imgHtml = data.imagem ? `<img src="${data.imagem}" alt="${data.nome}" style="width:60px;height:60px;border-radius:8px;object-fit:cover;border:2px solid #ff8c00;">` : '-';
        rows.push(`<tr>
          <td data-label="Nome">${data.nome}</td>
          <td data-label="Logo">${imgHtml}</td>
          <td data-label="A√ß√µes"><button class="btn-delete" onclick="deleteParceiro('${doc.id}')">Deletar</button></td>
        </tr>`);
      });
      list.innerHTML = rows.join('');
    }

    window.deleteParceiro = async (id) => {
      await deleteDoc(doc(db, 'parceiros', id));
      loadParceiros();
    };

    // Participa√ß√µes
    window.addParticipacao = async (e) => {
      e.preventDefault();
      await addDoc(collection(db, 'participacoes'), {
        titulo: document.getElementById('part-titulo').value,
        descricao: document.getElementById('part-desc').value,
        data: document.getElementById('part-data').value
      });
      e.target.reset();
      loadParticipacoes();
    };

    async function loadParticipacoes() {
      const list = document.getElementById('part-list');
      const snapshot = await getDocs(collection(db, 'participacoes'));
      const cards = [];
      snapshot.forEach(doc => {
        const data = doc.data();
        cards.push(`<div class="card">
          <h3>${data.titulo}</h3>
          <p>${data.descricao || ''}</p>
          <p><strong>Data:</strong> ${data.data}</p>
          <button class="btn-delete" onclick="deleteParticipacao('${doc.id}')">Deletar</button>
        </div>`);
      });
      list.innerHTML = cards.join('');
    }

    window.deleteParticipacao = async (id) => {
      await deleteDoc(doc(db, 'participacoes', id));
      loadParticipacoes();
    };

    // Avalia√ß√µes - Com listener em tempo real
    function loadAvaliacoes() {
      const list = document.getElementById('aval-list');
      console.log('Iniciando loadAvaliacoes...');
      
      try {
        onSnapshot(collection(db, 'avaliacoes'), (snapshot) => {
          console.log('Snapshot recebido:', snapshot.docs.length, 'documentos');
          
          if (snapshot.empty) {
            list.innerHTML = '<p style="text-align: center; color: #999;">Nenhuma avalia√ß√£o ainda</p>';
            return;
          }
          
          const cards = [];
          snapshot.forEach(doc => {
            const data = doc.data();
            console.log('Renderizando avalia√ß√£o:', data);
            cards.push(`<div class="card">
              <h3>${data.cliente || 'Sem nome'}</h3>
              <p><strong>Estrelas:</strong> ${data.estrelas || 0}/5</p>
              <p>${data.comentario || 'Sem coment√°rio'}</p>
              <p><small>${data.data || 'Sem data'}</small></p>
              <button class="btn-delete" onclick="deleteAvaliacao('${doc.id}')">Deletar</button>
            </div>`);
          });
          list.innerHTML = cards.join('');
        }, (error) => {
          console.error('Erro ao carregar avalia√ß√µes:', error);
          list.innerHTML = '<p style="color: red;">Erro ao carregar avalia√ß√µes</p>';
        });
      } catch (error) {
        console.error('Erro em loadAvaliacoes:', error);
      }
    }

    window.deleteAvaliacao = async (id) => {
      try {
        await deleteDoc(doc(db, 'avaliacoes', id));
        console.log('Avalia√ß√£o deletada:', id);
      } catch (error) {
        console.error('Erro ao deletar avalia√ß√£o:', error);
      }
    };

    // Localiza√ß√£o
    window.saveLocalizacao = async (e) => {
      e.preventDefault();
      const data = {
        endereco: document.getElementById('loc-endereco').value,
        bairro: document.getElementById('loc-bairro').value,
        cidade: document.getElementById('loc-cidade').value,
        referencia: document.getElementById('loc-referencia').value
      };
      await setDoc(doc(db, 'config', 'localizacao'), data);
      displayLocalizacao(data);
      e.target.reset();
    };

    async function displayLocalizacao(data) {
      const display = document.getElementById('loc-display');
      display.innerHTML = `
        <p><strong>üìç ${data.endereco}</strong></p>
        <p>${data.bairro}, ${data.cidade}</p>
        <p><em>${data.referencia}</em></p>
      `;
    }

    async function loadLocalizacao() {
      try {
        const docSnap = await getDoc(doc(db, 'config', 'localizacao'));
        if (docSnap.exists()) {
          const data = docSnap.data();
          document.getElementById('loc-endereco').value = data.endereco || '';
          document.getElementById('loc-bairro').value = data.bairro || '';
          document.getElementById('loc-cidade').value = data.cidade || '';
          document.getElementById('loc-referencia').value = data.referencia || '';
          displayLocalizacao(data);
        }
      } catch (error) {
        console.error('Erro ao carregar localiza√ß√£o:', error);
      }
    }

    // Hor√°rios
    window.saveHorarios = async (e) => {
      e.preventDefault();
      const data = {
        segSex: document.getElementById('hor-seg-sex').value,
        sabado: document.getElementById('hor-sabado').value,
        domingo: document.getElementById('hor-domingo').value
      };
      await setDoc(doc(db, 'config', 'horarios'), data);
      displayHorarios(data);
      e.target.reset();
    };

    async function displayHorarios(data) {
      const display = document.getElementById('hor-display');
      display.innerHTML = `
        <p><strong>‚è∞ Hor√°rios de Funcionamento</strong></p>
        <p>Segunda a Sexta: ${data.segSex}</p>
        <p>S√°bado: ${data.sabado}</p>
        <p>Domingo: ${data.domingo}</p>
      `;
    }

    async function loadHorarios() {
      try {
        const docSnap = await getDoc(doc(db, 'config', 'horarios'));
        if (docSnap.exists()) {
          const data = docSnap.data();
          document.getElementById('hor-seg-sex').value = data.segSex || '';
          document.getElementById('hor-sabado').value = data.sabado || '';
          document.getElementById('hor-domingo').value = data.domingo || '';
          displayHorarios(data);
        }
      } catch (error) {
        console.error('Erro ao carregar hor√°rios:', error);
      }
    }

    // Agendamento
    window.saveAgendamento = async (e) => {
      e.preventDefault();
      const data = {
        whatsapp: document.getElementById('agen-whatsapp').value,
        telefone: document.getElementById('agen-telefone').value,
        info: document.getElementById('agen-info').value
      };
      await setDoc(doc(db, 'config', 'agendamento'), data);
      displayAgendamento(data);
      e.target.reset();
    };

    async function displayAgendamento(data) {
      const display = document.getElementById('agen-display');
      const whatsappLink = `https://wa.me/${data.whatsapp.replace(/\D/g, '')}`;
      const telefoneLink = `tel:${data.telefone.replace(/\D/g, '')}`;
      display.innerHTML = `
        <p><strong>üìû Agendamento</strong></p>
        <p>WhatsApp: <a href="${whatsappLink}" target="_blank" style="color: #ff8c00; text-decoration: none;">${data.whatsapp} üí¨</a></p>
        <p>Telefone: <a href="${telefoneLink}" style="color: #ff8c00; text-decoration: none;">${data.telefone} ‚òéÔ∏è</a></p>
        <p>${data.info}</p>
      `;
    }

    async function loadAgendamento() {
      try {
        const docSnap = await getDoc(doc(db, 'config', 'agendamento'));
        if (docSnap.exists()) {
          const data = docSnap.data();
          document.getElementById('agen-whatsapp').value = data.whatsapp || '';
          document.getElementById('agen-telefone').value = data.telefone || '';
          document.getElementById('agen-info').value = data.info || '';
          displayAgendamento(data);
        }
      } catch (error) {
        console.error('Erro ao carregar agendamento:', error);
      }
    }

    // Carregar tudo ao iniciar
    loadServicos();
    loadProfissionais();
    loadParceiros();
    loadParticipacoes();
    loadLocalizacao();
    loadHorarios();
    loadAgendamento();
    loadAvaliacoes();
  </script>
</body>
</html>
